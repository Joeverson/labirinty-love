<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        .garden {
            position: relative;
            width: 200px;
            height: 200px;
            border: 5px solid #CCC;
            border-radius: 10px;
        }

        .ball {
            position: absolute;
            top: 90px;
            left: 90px;
            width: 20px;
            height: 20px;
            background: green;
            border-radius: 100%;
        }
    </style>
</head>

<body>
    <pre class="vals"></pre>
    <pre class="bateu"></pre>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        var socket = io();
        window.navigator.vibrate(200);

        socket.on('cli-die', () => {
            window.navigator.vibrate(200); // vibrate for 200ms
            document.body.style.backgroundColor= "#ff0000";
            document.querySelector('.bateu').innerHTML = 'bateu';
        })

        function handleOrientation(event) {
            var x = event.beta; // In degree in the range [-180,180] 
            var y = event.gamma; // In degree in the range [-90,90]             

            socket.emit('controls', directions(x, y));
        }

        function directions(x, y) {
            let pos;
            
            if (x < -10) {
                pos = { pos: 'left', velocity: x };
            } else if (x >= 10) {
                pos = { pos: 'right', velocity: x };
            } else if (y >= 10) {
                pos = { pos: 'up', velocity: y };
            } else if (y < -10) {
                pos = { pos: 'down', velocity: y };
            }
            
            // mostrando onde esta
            document.querySelector('.vals').innerHTML = `Pos=${pos}, x=${x.toFixed(3)}, y=${y.toFixed(3)}`;
            
            return pos;
        }

        window.addEventListener('deviceorientation', handleOrientation);
    </script>
</body>

</html>